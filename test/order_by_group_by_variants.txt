# ORDER BY and GROUP BY/HAVING Variant Test Cases

# ============ ORDER BY - Valid ============
SELECT * FROM users ORDER BY last_name ASC;
SELECT * FROM products ORDER BY price DESC;
SELECT * FROM employees ORDER BY dept ASC, salary DESC;
SELECT name, salary FROM staff ORDER BY 2 DESC;
SELECT * FROM events ORDER BY event_date DESC, event_time DESC;
SELECT * FROM items ORDER BY category ASC, price;
SELECT name FROM users ORDER BY LENGTH(name) DESC;
SELECT * FROM tbl ORDER BY col1 + col2 DESC;
SELECT * FROM data ORDER BY (CASE WHEN priority='High' THEN 1 ELSE 2 END);
SELECT * FROM list ORDER BY task_name COLLATE "C";
SELECT id, name FROM users ORDER BY name NULLS LAST;
SELECT * FROM blog_posts ORDER BY published_at DESC LIMIT 10;
SELECT DISTINCT country FROM customers ORDER BY country;
SELECT email FROM users ORDER BY LOWER(email);
SELECT * FROM logs ORDER BY 1, 2, 3;
SELECT * FROM items ORDER BY price * tax_rate;
SELECT name, age FROM students ORDER BY age DESC, name ASC;
SELECT * FROM results ORDER BY score DESC, finished_at ASC;
SELECT * FROM products ORDER BY category, brand, model;
SELECT * FROM users ORDER BY RAND();

# ============ GROUP BY / HAVING - Valid ============
SELECT dept, COUNT(*) FROM emp GROUP BY dept HAVING COUNT(*) > 5;
SELECT cat, SUM(price) FROM items GROUP BY cat HAVING SUM(price) BETWEEN 1000 AND 5000;
SELECT user_id, AVG(score) FROM tests GROUP BY user_id HAVING AVG(score) < 50;
SELECT city, COUNT(*) FROM users GROUP BY city HAVING city LIKE 'New%';
SELECT order_id, SUM(qty) FROM lines GROUP BY order_id HAVING COUNT(*) > 1;
SELECT class, MIN(age) FROM students GROUP BY class HAVING MIN(age) >= 18;
SELECT tag, COUNT(*) FROM posts GROUP BY tag HAVING COUNT(*) != 0;
SELECT job, MAX(sal) FROM emp GROUP BY job HAVING MAX(sal) > 5000 AND MAX(sal) < 10000;
SELECT prod_id, COUNT(*) FROM sales GROUP BY prod_id HAVING COUNT(*) > 10 OR SUM(amt) > 1000;
SELECT id, SUM(v) FROM t GROUP BY id HAVING SUM(v) IS NOT NULL;
SELECT name FROM people GROUP BY name HAVING COUNT(*) > 1;
SELECT dept FROM staff GROUP BY dept HAVING AVG(age) > 30;
SELECT type, SUM(weight) FROM cargo GROUP BY type HAVING SUM(weight) > 500.50;
SELECT brand FROM cars GROUP BY brand HAVING MAX(year) = 2024;
SELECT region FROM sales GROUP BY region HAVING SUM(rev) > 0;
SELECT id FROM logs GROUP BY id HAVING MIN(ts) > '2023-01-01';
SELECT grp FROM data GROUP BY grp HAVING COUNT(*) % 2 = 0;
SELECT code FROM codes GROUP BY code HAVING LENGTH(code) > 3;

# ============ GROUP BY - Valid ============
SELECT department, COUNT(*) FROM employees GROUP BY department;
SELECT category, sub_category, SUM(qty) FROM stock GROUP BY category, sub_category;
SELECT YEAR(order_date), COUNT(id) FROM orders GROUP BY YEAR(order_date);
SELECT region, AVG(salary) FROM staff GROUP BY 1;
SELECT status, COUNT(*) FROM tasks GROUP BY status ORDER BY status;
SELECT gender, COUNT(*) FROM users GROUP BY gender WITH ROLLUP;
SELECT country, city, SUM(pop) FROM geo GROUP BY country, city;
SELECT LEFT(zip, 3), COUNT(*) FROM addresses GROUP BY LEFT(zip, 3);
SELECT active_status, COUNT(*) FROM tbl GROUP BY active_status;
SELECT dept_id FROM emp GROUP BY dept_id;
SELECT COALESCE(type, 'Other'), COUNT(*) FROM items GROUP BY COALESCE(type, 'Other');
SELECT category AS cat, SUM(stock) FROM inv GROUP BY cat;
SELECT LOWER(email_domain), COUNT(*) FROM subs GROUP BY LOWER(email_domain);
SELECT tenant_id, user_type, COUNT(*) FROM auth GROUP BY tenant_id, user_type;
SELECT department_id FROM employees GROUP BY department_id;
SELECT category FROM goods GROUP BY category HAVING COUNT(DISTINCT color) > 2;
SELECT (price > 100), COUNT(*) FROM products GROUP BY (price > 100);
